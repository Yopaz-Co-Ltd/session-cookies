\documentclass[aspectratio=169]{beamer}
\usetheme{CambridgeUS}
\usepackage[utf8]{inputenc}
\usepackage[vietnamese]{babel}
\usepackage{graphicx}

\title{Cookie \& Session\\Báº¡n Ä‘Ã£ tháº­t sá»± hiá»ƒu?}
\author{LÃª VÄƒn QuÃ¢n}
\date{\today}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Má»Ÿ Ä‘áº§u cÃ¢u chuyá»‡n}
  \begin{itemize}
    \item NgÃ y xÆ°a, khi chÆ°a cÃ³ cookie hay session
    \item Server khÃ´ng thá»ƒ phÃ¢n biá»‡t Ä‘Æ°á»£c ngÆ°á»i dÃ¹ng nÃ o Ä‘ang truy cáº­p.
    \item LÃ½ do:
    \begin{itemize}
        \item HTTP lÃ  giao thá»©c \textbf{stateless}
        \item Má»—i request Ä‘á»™c láº­p, khÃ´ng ``nhá»›'' request trÆ°á»›c.
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Khi khÃ´ng cÃ³ cookie/session, server lÃ m gÃ¬?}
  \begin{enumerate}
    \item Gáº¯n ID vÃ o URL (URL rewriting):\\
    \texttt{/profile?user\_id=123}
    \item DÃ¹ng hidden field trong form:\\
    \texttt{<input type="hidden" value="123" name="user\_id">}
    \item Theo dÃµi Ä‘á»‹a chá»‰ IP
  \end{enumerate}
  \vspace{1em}
  \textbf{NhÆ°á»£c Ä‘iá»ƒm:} khÃ´ng báº£o máº­t, dá»… giáº£ máº¡o, khÃ´ng tiá»‡n lá»£i
\end{frame}

\begin{frame}{Sá»± ra Ä‘á»i cá»§a Cookie}
  \begin{itemize}
    \item \textbf{1994} â€“ Lou Montulli (ká»¹ sÆ° táº¡i Netscape) Ä‘á» xuáº¥t cÆ¡ cháº¿ Cookie
    \item Cookie lÃ  má»™t Ä‘oáº¡n dá»¯ liá»‡u nhá» mÃ  server gá»­i kÃ¨m theo má»—i pháº£n há»“i HTTP vÃ  Ä‘Æ°á»£c trÃ¬nh duyá»‡t lÆ°u láº¡i. Sau Ä‘Ã³, trÃ¬nh duyá»‡t sáº½ tá»± Ä‘á»™ng gá»­i láº¡i cookie nÃ y trong cÃ¡c yÃªu cáº§u tiáº¿p theo Ä‘áº¿n cÃ¹ng server.
    \item Má»¥c tiÃªu: giáº£i quyáº¿t viá»‡c lÆ°u tráº¡ng thÃ¡i ngÆ°á»i dÃ¹ng trong giao thá»©c HTTP (vá»‘n stateless)
    \item Sau nÃ y Ä‘Æ°á»£c chuáº©n hÃ³a trong \textbf{RFC 2109} (1997) â†’ \textbf{RFC 6265} (2011)
  \end{itemize}
\end{frame}

\begin{frame}{CÃ³ nhá»¯ng cÃ¡ch nÃ o Ä‘á»ƒ set Cookie?}
  \begin{itemize}
    \item \textbf{1. Set cookie báº±ng HTTP header (thÆ°á»ng dÃ¹ng trong backend)}:
      \begin{enumerate}
        \item VÃ­ dá»¥ PHP: \texttt{setcookie("user\_id", "12345", time() + 3600);}
        \item Tráº£ vá» header: \texttt{Set-Cookie: user\_id=12345; Expires=...}
      \end{enumerate}

    \item \textbf{2. Set cookie báº±ng JavaScript (trÃªn trÃ¬nh duyá»‡t)}:
      \begin{itemize}
        \item \texttt{document.cookie = "theme=dark; path=/; max-age=3600";}
        \item CÃ³ thá»ƒ set cookie Ä‘á»™ng tuá»³ tÃ¬nh huá»‘ng UX/UI
      \end{itemize}

    \item \textbf{3. Set cookie thÃ´ng qua HTTP response tá»« server (giao tiáº¿p backend/frontend)}:
      \begin{itemize}
        \item CÃ¡c framework backend (Laravel, Express, v.v.) Ä‘á»u há»— trá»£
        \item VÃ­ dá»¥: trong Laravel â†’ \texttt{return response(...)->cookie(...);}
      \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{CÃ¡ch hoáº¡t Ä‘á»™ng:}
  \begin{enumerate}
    \item Server gá»­i header: \texttt{Set-Cookie: user\_id=12345}
    \item TrÃ¬nh duyá»‡t lÆ°u cookie vÃ o mÃ¡y
    \item Trong cÃ¡c request sau, trÃ¬nh duyá»‡t gá»­i: \texttt{Cookie: user\_id=12345}
  \end{enumerate}

  \vspace{0.5em}
  \textbf{Nhá» váº­y:} Server cÃ³ thá»ƒ nháº­n biáº¿t user trong má»—i request
\end{frame}

\begin{frame}{Váº¥n Ä‘á» báº£o máº­t vá»›i Cookie}
  \begin{itemize}
    \item Cookie Ä‘Æ°á»£c lÆ°u phÃ­a ngÆ°á»i dÃ¹ng â†’ ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ sá»­a!
    \item VÃ­ dá»¥: \texttt{user\_id=12345} tá»± Ä‘á»•i thÃ nh \texttt{user\_id=1}
    \item Khi Ä‘Ã³, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ máº¡o danh ngÆ°á»i khÃ¡c náº¿u server khÃ´ng kiá»ƒm tra cáº©n tháº­n
    \item NgoÃ i ra:
    \begin{itemize}
      \item Cookie cÃ³ thá»ƒ bá»‹ Ä‘Ã¡nh cáº¯p qua XSS
      \item Cookie gá»­i kÃ¨m má»i request â†’ rÃ² rá»‰ thÃ´ng tin
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Giáº£i phÃ¡p ra Ä‘á»i: Session!}
  \begin{itemize}
    \item Session báº¯t Ä‘áº§u xuáº¥t hiá»‡n vÃ  Ä‘Æ°á»£c chuáº©n hoÃ¡ khoáº£ng tá»« nÄƒm 1996â€“1997
    \item Session lÆ°u thÃ´ng tin trÃªn server, chá»‰ gá»­i ID cho client
    \item Cookie chá»‰ chá»©a \texttt{session\_id}, khÃ´ng chá»©a thÃ´ng tin quan trá»ng
    \item NgÆ°á»i dÃ¹ng khÃ´ng thá»ƒ sá»­a dá»¯ liá»‡u session vÃ¬ nÃ³ náº±m trÃªn server
    \item Nhá» Ä‘Ã³: báº£o máº­t tá»‘t hÆ¡n, trÃ¡nh máº¡o danh vÃ  can thiá»‡p
  \end{itemize}
\end{frame}

\begin{frame}{TÃ¬nh huá»‘ng thá»±c táº¿ ğŸ¤”}
\begin{itemize}
  \item TrÃªn má»™t trang web xem phim
  \item TÃ´i lÃ  tÃ i khoáº£n \textbf{free}, cÃ²n báº¡n lÃ  \textbf{premium}
  \item TÃ´i láº¥y Ä‘Æ°á»£c \texttt{cookie} cá»§a báº¡n (auth\_token, session\_id, v.v.)
  \item TÃ´i gÃ¡n vÃ o trÃ¬nh duyá»‡t cá»§a mÃ¬nh vÃ ... \textbf{truy cáº­p Ä‘Æ°á»£c phim premium!}
\end{itemize}

\vspace{1em}
\alert{CÃ¢u há»i:} Liá»‡u chá»‰ dÃ¹ng session lÃ  Ä‘á»§ Ä‘á»ƒ ngÄƒn cháº·n?
\end{frame}

\begin{frame}{Chá»‰ dÃ¹ng Session liá»‡u cÃ³ Ä‘á»§?}
\begin{itemize}
  \item Session lÆ°u trÃªn server â€“ tá»‘t hÆ¡n cookie thuáº§n tuÃ½
  \item NhÆ°ng: session\_id váº«n gá»­i qua cookie â†’ \textbf{cÃ³ thá»ƒ bá»‹ Ä‘Ã¡nh cáº¯p}
  \item Náº¿u attacker gÃ¡n session\_id vÃ o trÃ¬nh duyá»‡t há» â†’ Server váº«n tin tÆ°á»Ÿng!
\end{itemize}

\vspace{1em}
\textbf{Káº¿t luáº­n:} Session lÃ  cáº§n thiáº¿t, nhÆ°ng \alert{khÃ´ng Ä‘á»§} Ä‘á»ƒ ngÄƒn giáº£ máº¡o!
\end{frame}

\begin{frame}{Giáº£i phÃ¡p chá»‘ng giáº£ máº¡o session}
\begin{itemize}
  \item ğŸ”’ RÃ ng buá»™c session vá»›i:
  \begin{itemize}
    \item Äá»‹a chá»‰ IP gá»‘c
    \item TrÃ¬nh duyá»‡t (User-Agent)
  \end{itemize}

  \item â³ Háº¡n cháº¿ thá»i gian sá»‘ng cá»§a session (timeout)
  \item ğŸ›¡ Thiáº¿t láº­p cookie vá»›i \texttt{HttpOnly}, \texttt{Secure}, \texttt{SameSite=Strict}
  \item ğŸ” Báº£o vá»‡ form vá»›i \textbf{CSRF Token}
  \item âœ… LuÃ´n kiá»ƒm tra quyá»n truy cáº­p phÃ­a server trÆ°á»›c khi gá»­i dá»¯ liá»‡u quan trá»ng (vÃ­ dá»¥: file video)
\end{itemize}
\end{frame}

\begin{frame}{So sÃ¡nh nhanh Cookie vs Session}
  \centering
  \renewcommand{\arraystretch}{1.5}
  \begin{tabular}{|l|c|c|}
    \hline
    \textbf{TiÃªu chÃ­} & \textbf{Cookie} & \textbf{Session} \\
    \hline
    LÆ°u á»Ÿ Ä‘Ã¢u         & TrÃ¬nh duyá»‡t     & Server \\
    \hline
    Báº£o máº­t           & Tháº¥p            & Cao \\
    \hline
    Dung lÆ°á»£ng        & \textasciitilde 4KB & Tuá»³ server \\
    \hline
    Thá»i gian sá»‘ng    & Tuá»³ cÃ i Ä‘áº·t     & Tuá»³ cáº¥u hÃ¬nh \\
    \hline
  \end{tabular}
\end{frame}

\begin{frame}{á»¨ng dá»¥ng cá»§a Cookie}
  \begin{itemize}
    \item \textbf{LÆ°u tÃ¹y chá»n ngÆ°á»i dÃ¹ng}: Theme (tá»‘i/sÃ¡ng), ngÃ´n ngá»¯, layout cÃ¡ nhÃ¢n
    \item \textbf{Theo dÃµi giá» hÃ ng táº¡m thá»i}: LÆ°u ID sáº£n pháº©m trÆ°á»›c khi ngÆ°á»i dÃ¹ng Ä‘Äƒng nháº­p
    \item \textbf{Theo dÃµi hÃ nh vi ngÆ°á»i dÃ¹ng}: DÃ¹ng bá»Ÿi Google Analytics, Facebook Pixel, v.v.
    \item \textbf{Ghi nhá»› Ä‘Äƒng nháº­p (Remember me)}: Duy trÃ¬ tráº¡ng thÃ¡i Ä‘Äƒng nháº­p qua nhiá»u láº§n truy cáº­p
    \item \textbf{Quáº£n lÃ½ popup/thÃ´ng bÃ¡o}: Ghi nhá»› ngÆ°á»i dÃ¹ng Ä‘Ã£ táº¯t thÃ´ng bÃ¡o, khÃ´ng hiá»ƒn thá»‹ láº¡i
    \item \textbf{A/B Testing}: GÃ¡n user vÃ o nhÃ³m A hoáº·c B Ä‘á»ƒ thá»­ nghiá»‡m giao diá»‡n
  \end{itemize}
\end{frame}

\begin{frame}{á»¨ng dá»¥ng cá»§a Session}
  \begin{itemize}
    \item \textbf{Giá» hÃ ng trong e-commerce}: LÆ°u thÃ´ng tin sáº£n pháº©m, sá»‘ lÆ°á»£ng theo session
    \item \textbf{Táº¡m lÆ°u dá»¯ liá»‡u form}: TrÃ¡nh máº¥t dá»¯ liá»‡u náº¿u submit lá»—i
    \item \textbf{Chá»‘ng gá»­i form nhiá»u láº§n}: XÃ¡c thá»±c token chá»‘ng CSRF
    \item \textbf{Theo dÃµi user Ä‘ang hoáº¡t Ä‘á»™ng}: Hiá»ƒn thá»‹ tráº¡ng thÃ¡i â€œonlineâ€ trong há»‡ thá»‘ng
    \item \textbf{LÆ°u vá»‹ trÃ­ Ä‘iá»u hÆ°á»›ng trÆ°á»›c Ä‘Ã³}: Redirect vá» trang trÆ°á»›c sau khi Ä‘Äƒng nháº­p
    \item \textbf{LÆ°u tiáº¿n trÃ¬nh thao tÃ¡c}: NhÆ° trong cÃ¡c bÆ°á»›c Ä‘Äƒng kÃ½ nhiá»u bÆ°á»›c (multi-step form)
  \end{itemize}
\end{frame}

\begin{frame}{Káº¿t luáº­n}
  \begin{itemize}
    \item Cookie \& Session lÃ  ná»n táº£ng cho má»i website hiá»‡n Ä‘áº¡i
    \item Tá»« chá»— ``khÃ´ng thá»ƒ nhá»› ai'' â†’ Web cÃ¡ nhÃ¢n hÃ³a, báº£o máº­t hÆ¡n
    \item GiÃºp tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng trá»Ÿ nÃªn mÆ°á»£t mÃ  vÃ  Ä‘Ã¡ng tin cáº­y
  \end{itemize}
\end{frame}
\end{document}
